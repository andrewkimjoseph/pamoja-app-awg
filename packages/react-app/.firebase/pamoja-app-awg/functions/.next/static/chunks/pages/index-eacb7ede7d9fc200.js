(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5405],{7314:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(1487)}])},1487:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Home}});var a=n(2322),s=n(694),r=n(1777),o=n(4510),l=n(5408);let getContributor=async e=>{let t=null;if(window.ethereum){let n=new s.Q(window.ethereum),a=n.getSigner(e),i=new r.CH(l.z,o.Y,a);try{let n=await i.callStatic.checkIfContributorExists(e);if(n){let n=await i.callStatic.getContributor(e);t={_id:parseInt(n._id.toString()),_address:n._address,_username:n._username}}}catch(e){}}return t};var i=n(8797),d=n(2784),u=n(5627);let addContributorToDirectory=async(e,t)=>{let{_username:n}=t;if(window.ethereum){let t=new s.Q(window.ethereum),a=t.getSigner(e),i=new r.CH(l.z,o.Y,a);try{let t=await i.addContributorToDirectory(n,e);await t.wait()}catch(e){console.log(e)}}};var c=n(6963),p=n(2758),m=n(4973),h=n(480);let approvePamojaAppContractToWithdrawFunds=async(e,t)=>{let{_amount:n}=t;if(window.ethereum){let t=new s.Q(window.ethereum),a=t.getSigner(e);new r.CH(l.z,o.Y,a);let i=new r.CH(p.E,c.e,a);try{let e=await i.approve(l.z,(0,h.f)("".concat(n))),t=await e.wait(),a=m.$.decode(["bool"],t.transactionHash);return a.at(0)}catch(e){console.log(e)}}return!1},getAmountApprovedForPamojaContract=async e=>{let t=0;if(window.ethereum){let n=new s.Q(window.ethereum),a=n.getSigner(e),o=new r.CH(p.E,c.e,a);try{return t=await o.callStatic.allowance(e,l.z),parseInt(t.toString())}catch(e){}}return t};var b=n(9472),snackbar=e=>{let{isOpen:t,message:n,onClose:s}=e;return t?(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-lg flex flex-col",children:(0,a.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,a.jsx)("p",{className:"text-lg font-semibold",children:n}),(0,a.jsx)("button",{className:"text-gray-500 hover:text-gray-700",onClick:s,children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})}):null},x=n(9097),y=n.n(x);function Home(){let[e,t]=(0,d.useState)(""),[n,s]=(0,d.useState)(!1),{address:r,isConnected:o}=(0,u.m)(),[l,c]=(0,d.useState)(!1),[p,m]=(0,d.useState)(!1),[h,x]=(0,d.useState)(""),[f,w]=(0,d.useState)(250),[g,v]=(0,d.useState)(null),[j,_]=(0,d.useState)(!1),[N,C]=(0,d.useState)(!1),[S,k]=(0,d.useState)(0),[A,M]=(0,d.useState)(!1),[E,$]=(0,d.useState)(null),[P,T]=(0,d.useState)(!1),[W,z]=(0,d.useState)("");(0,d.useEffect)(()=>{fetchContributor(),fetchContributions(),fetchAmountApproved(),s(!0)},[]),(0,d.useEffect)(()=>{o&&r&&t(r)},[r,o]);let fetchContributor=async()=>{let e=await getContributor(r);v(e)},fetchContributions=async()=>{let e=await (0,i.k)(r),t=e.reduce((e,t)=>e+t._amount,0);k(t)},fetchAmountApproved=async()=>{let e=await getAmountApprovedForPamojaContract(r);$(e)},handleModalSubmit=async()=>{let e=h.trim();""===e?C(!0):(_(!0),await addContributorToDirectory(r,{_username:e,_contributorAddress:r}),await fetchContributor(),c(!1),x(""),_(!1))},handleApproveModalSubmit=async()=>{_(!0);let e=await approvePamojaAppContractToWithdrawFunds(r,{_amount:f});_(!1),e?(M(!0),m(!1),z("Approval successful!")):(M(!1),m(!1),z("Approval failed. Please try again.")),T(!0)};return n?(0,a.jsxs)(a.Fragment,{children:[!n&&(0,a.jsx)(b.Z,{}),(0,a.jsxs)("div",{className:"container mx-auto bg-pa_two flex flex-col justify-start items-center min-h-screen w-5/6",children:[(0,a.jsx)("h2",{className:"text-4xl font-bold mt-6 mb-2",children:"Pamoja App 0.1.0"}),(0,a.jsxs)("h4",{className:"text-2xl font-bold mt-6 mb-2 p-4",children:["Welcome",g&&", ".concat(g._username," [").concat(g._id,"]"),"!"]}),(0,a.jsx)("p",{className:"mb-4 p-4",children:"Together, you and others can pool money and save for greater causes. - Around We Go!"}),o?(0,a.jsx)("div",{className:"bg-pa_one text-white p-4 rounded-lg shadow-md w-full mb-4",children:(0,a.jsx)("p",{children:"Status: Connected"})}):(0,a.jsx)("div",{className:"bg-gray-200 p-4 rounded-lg shadow-md w-full mb-4",children:(0,a.jsx)("p",{children:"No Wallet Connected"})}),(0,a.jsxs)("div",{className:"bg-pa_three p-4 rounded-lg shadow-md w-full mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Total Saved"}),(0,a.jsxs)("p",{children:[" ",S," cUSD"]})]}),(0,a.jsxs)("div",{className:"p-6",children:[null===g&&(0,a.jsx)("button",{className:"bg-pa_one text-pa_two font-bold py-2 px-4 rounded mb-4 border border-pa_one",onClick:()=>c(!0),children:"Get started"}),null!==g&&0===E&&null!==E&&!A&&(0,a.jsx)("button",{className:"bg-pa_two text-first font-bold py-2 px-4 rounded mb-4 border border-pa_one",onClick:()=>m(!0),children:"Approve Pamoja App"}),null!==g&&0!==E&&null!==E&&0==S&&!A&&(0,a.jsx)(y(),{href:"/savings",className:"bg-pa_three text-first font-bold py-2 px-4 rounded mb-4 border border-pa_one",children:"Start saving"})]}),l&&(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50 border border-pa_one",children:(0,a.jsxs)("div",{className:"bg-pa_two p-6 rounded-lg shadow-lg relative border border-pa_three",children:[(0,a.jsx)("button",{className:"absolute top-2 right-2 text-gray-500 hover:text-gray-700",onClick:()=>{c(!1),x(""),C(!1)},children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Enter Username"}),(0,a.jsx)("input",{type:"text",value:h,onChange:e=>{x(e.target.value),C(!1)},className:"border border-gray-400 p-2 rounded mb-4",placeholder:"Enter your username"}),N&&(0,a.jsx)("p",{className:"text-red-500 mb-4",children:"Please enter a valid username."}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("button",{className:"mt-4 bg-pa_one text-pa_two py-2 px-4 rounded flex items-center",onClick:handleModalSubmit,disabled:j,children:j?(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-pa_three"}):"Submit"})})]})}),(0,a.jsx)(snackbar,{isOpen:P,message:W,onClose:()=>{T(!1),z("")}}),p&&(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg relative",children:[(0,a.jsx)("button",{className:"absolute top-2 right-2 text-gray-500 hover:text-gray-700",onClick:()=>m(!1),children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,a.jsx)("h2",{className:"text-xl font-bold mb-4 pt-4 pb-2",children:"Approve Pamoja App"}),(0,a.jsx)("h2",{className:"text-l mb-4",children:"Write your target saving amount. Note:"}),(0,a.jsxs)("h2",{className:"text-l italic",children:[" ","- Pamoja App will not withdraw anything now."]}),(0,a.jsx)("h2",{className:"text-l italic",children:" - The amount is only a capping. "}),(0,a.jsxs)("h2",{className:"text-l italic pb-4",children:[" ","- You have full control over your funds."," "]}),(0,a.jsx)("input",{type:"number",value:f,onChange:e=>w(Number(e.target.value)),className:"border border-gray-400 p-2 rounded mb-4",placeholder:"Enter amount"}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("button",{className:"mt-4 bg-pa_one text-pa_two py-2 px-4 rounded flex items-center",onClick:handleApproveModalSubmit,disabled:j,children:j?(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-pa_three"}):"Submit"})})]})})]})]}):(0,a.jsx)(b.Z,{})}},6963:function(e,t,n){"use strict";n.d(t,{e:function(){return a}});let a=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"},{name:"_spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{payable:!0,stateMutability:"payable",type:"fallback"},{anonymous:!1,inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"}]},2758:function(e,t,n){"use strict";n.d(t,{E:function(){return a}});let a="0x874069fa1eb16d44d622f2e0ca25eea172369bc1"},480:function(e,t,n){"use strict";n.d(t,{f:function(){return parseEther}});var a=n(628);function parseEther(e,t="wei"){return function(e,t){let[n,a="0"]=e.split("."),s=n.startsWith("-");if(s&&(n=n.slice(1)),a=a.replace(/(0+)$/,""),0===t)1===Math.round(Number(`.${a}`))&&(n=`${BigInt(n)+1n}`),a="";else if(a.length>t){let[e,s,r]=[a.slice(0,t-1),a.slice(t-1,t),a.slice(t)],o=Math.round(Number(`${s}.${r}`));(a=o>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${o}`).length>t&&(a=a.slice(1),n=`${BigInt(n)+1n}`),a=a.slice(0,t)}else a=a.padEnd(t,"0");return BigInt(`${s?"-":""}${n}${a}`)}(e,a.ez[t])}}},function(e){e.O(0,[2736,6007,9774,2888,179],function(){return e(e.s=7314)}),_N_E=e.O()}]);